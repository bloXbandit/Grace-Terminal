import{h as w}from"./http-D7M9oJmQ.js";import{n as A,a2 as E}from"./index-y24F1-rU.js";var x={exports:{}},I={exports:{}};(function(){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l={rotl:function(s,c){return s<<c|s>>>32-c},rotr:function(s,c){return s<<32-c|s>>>c},endian:function(s){if(s.constructor==Number)return l.rotl(s,8)&16711935|l.rotl(s,24)&4278255360;for(var c=0;c<s.length;c++)s[c]=l.endian(s[c]);return s},randomBytes:function(s){for(var c=[];s>0;s--)c.push(Math.floor(Math.random()*256));return c},bytesToWords:function(s){for(var c=[],i=0,f=0;i<s.length;i++,f+=8)c[f>>>5]|=s[i]<<24-f%32;return c},wordsToBytes:function(s){for(var c=[],i=0;i<s.length*32;i+=8)c.push(s[i>>>5]>>>24-i%32&255);return c},bytesToHex:function(s){for(var c=[],i=0;i<s.length;i++)c.push((s[i]>>>4).toString(16)),c.push((s[i]&15).toString(16));return c.join("")},hexToBytes:function(s){for(var c=[],i=0;i<s.length;i+=2)c.push(parseInt(s.substr(i,2),16));return c},bytesToBase64:function(s){for(var c=[],i=0;i<s.length;i+=3)for(var f=s[i]<<16|s[i+1]<<8|s[i+2],p=0;p<4;p++)i*8+p*6<=s.length*8?c.push(u.charAt(f>>>6*(3-p)&63)):c.push("=");return c.join("")},base64ToBytes:function(s){s=s.replace(/[^A-Z0-9+\/]/ig,"");for(var c=[],i=0,f=0;i<s.length;f=++i%4)f!=0&&c.push((u.indexOf(s.charAt(i-1))&Math.pow(2,-2*f+8)-1)<<f*2|u.indexOf(s.charAt(i))>>>6-f*2);return c}};I.exports=l})();var V=I.exports,m={utf8:{stringToBytes:function(u){return m.bin.stringToBytes(unescape(encodeURIComponent(u)))},bytesToString:function(u){return decodeURIComponent(escape(m.bin.bytesToString(u)))}},bin:{stringToBytes:function(u){for(var l=[],s=0;s<u.length;s++)l.push(u.charCodeAt(s)&255);return l},bytesToString:function(u){for(var l=[],s=0;s<u.length;s++)l.push(String.fromCharCode(u[s]));return l.join("")}}},_=m;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var L=function(u){return u!=null&&(B(u)||P(u)||!!u._isBuffer)};function B(u){return!!u.constructor&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function P(u){return typeof u.readFloatLE=="function"&&typeof u.slice=="function"&&B(u.slice(0,0))}(function(){var u=V,l=_.utf8,s=L,c=_.bin,i=function(f,p){f.constructor==String?p&&p.encoding==="binary"?f=c.stringToBytes(f):f=l.stringToBytes(f):s(f)?f=Array.prototype.slice.call(f,0):!Array.isArray(f)&&f.constructor!==Uint8Array&&(f=f.toString());for(var n=u.bytesToWords(f),v=f.length*8,t=1732584193,r=-271733879,o=-1732584194,e=271733878,a=0;a<n.length;a++)n[a]=(n[a]<<8|n[a]>>>24)&16711935|(n[a]<<24|n[a]>>>8)&4278255360;n[v>>>5]|=128<<v%32,n[(v+64>>>9<<4)+14]=v;for(var d=i._ff,h=i._gg,g=i._hh,y=i._ii,a=0;a<n.length;a+=16){var T=t,C=r,U=o,k=e;t=d(t,r,o,e,n[a+0],7,-680876936),e=d(e,t,r,o,n[a+1],12,-389564586),o=d(o,e,t,r,n[a+2],17,606105819),r=d(r,o,e,t,n[a+3],22,-1044525330),t=d(t,r,o,e,n[a+4],7,-176418897),e=d(e,t,r,o,n[a+5],12,1200080426),o=d(o,e,t,r,n[a+6],17,-1473231341),r=d(r,o,e,t,n[a+7],22,-45705983),t=d(t,r,o,e,n[a+8],7,1770035416),e=d(e,t,r,o,n[a+9],12,-1958414417),o=d(o,e,t,r,n[a+10],17,-42063),r=d(r,o,e,t,n[a+11],22,-1990404162),t=d(t,r,o,e,n[a+12],7,1804603682),e=d(e,t,r,o,n[a+13],12,-40341101),o=d(o,e,t,r,n[a+14],17,-1502002290),r=d(r,o,e,t,n[a+15],22,1236535329),t=h(t,r,o,e,n[a+1],5,-165796510),e=h(e,t,r,o,n[a+6],9,-1069501632),o=h(o,e,t,r,n[a+11],14,643717713),r=h(r,o,e,t,n[a+0],20,-373897302),t=h(t,r,o,e,n[a+5],5,-701558691),e=h(e,t,r,o,n[a+10],9,38016083),o=h(o,e,t,r,n[a+15],14,-660478335),r=h(r,o,e,t,n[a+4],20,-405537848),t=h(t,r,o,e,n[a+9],5,568446438),e=h(e,t,r,o,n[a+14],9,-1019803690),o=h(o,e,t,r,n[a+3],14,-187363961),r=h(r,o,e,t,n[a+8],20,1163531501),t=h(t,r,o,e,n[a+13],5,-1444681467),e=h(e,t,r,o,n[a+2],9,-51403784),o=h(o,e,t,r,n[a+7],14,1735328473),r=h(r,o,e,t,n[a+12],20,-1926607734),t=g(t,r,o,e,n[a+5],4,-378558),e=g(e,t,r,o,n[a+8],11,-2022574463),o=g(o,e,t,r,n[a+11],16,1839030562),r=g(r,o,e,t,n[a+14],23,-35309556),t=g(t,r,o,e,n[a+1],4,-1530992060),e=g(e,t,r,o,n[a+4],11,1272893353),o=g(o,e,t,r,n[a+7],16,-155497632),r=g(r,o,e,t,n[a+10],23,-1094730640),t=g(t,r,o,e,n[a+13],4,681279174),e=g(e,t,r,o,n[a+0],11,-358537222),o=g(o,e,t,r,n[a+3],16,-722521979),r=g(r,o,e,t,n[a+6],23,76029189),t=g(t,r,o,e,n[a+9],4,-640364487),e=g(e,t,r,o,n[a+12],11,-421815835),o=g(o,e,t,r,n[a+15],16,530742520),r=g(r,o,e,t,n[a+2],23,-995338651),t=y(t,r,o,e,n[a+0],6,-198630844),e=y(e,t,r,o,n[a+7],10,1126891415),o=y(o,e,t,r,n[a+14],15,-1416354905),r=y(r,o,e,t,n[a+5],21,-57434055),t=y(t,r,o,e,n[a+12],6,1700485571),e=y(e,t,r,o,n[a+3],10,-1894986606),o=y(o,e,t,r,n[a+10],15,-1051523),r=y(r,o,e,t,n[a+1],21,-2054922799),t=y(t,r,o,e,n[a+8],6,1873313359),e=y(e,t,r,o,n[a+15],10,-30611744),o=y(o,e,t,r,n[a+6],15,-1560198380),r=y(r,o,e,t,n[a+13],21,1309151649),t=y(t,r,o,e,n[a+4],6,-145523070),e=y(e,t,r,o,n[a+11],10,-1120210379),o=y(o,e,t,r,n[a+2],15,718787259),r=y(r,o,e,t,n[a+9],21,-343485551),t=t+T>>>0,r=r+C>>>0,o=o+U>>>0,e=e+k>>>0}return u.endian([t,r,o,e])};i._ff=function(f,p,n,v,t,r,o){var e=f+(p&n|~p&v)+(t>>>0)+o;return(e<<r|e>>>32-r)+p},i._gg=function(f,p,n,v,t,r,o){var e=f+(p&v|n&~v)+(t>>>0)+o;return(e<<r|e>>>32-r)+p},i._hh=function(f,p,n,v,t,r,o){var e=f+(p^n^v)+(t>>>0)+o;return(e<<r|e>>>32-r)+p},i._ii=function(f,p,n,v,t,r,o){var e=f+(n^(p|~v))+(t>>>0)+o;return(e<<r|e>>>32-r)+p},i._blocksize=16,i._digestsize=16,x.exports=function(f,p){if(f==null)throw new Error("Illegal argument "+f);var n=u.wordsToBytes(i(f,p));return p&&p.asBytes?n:p&&p.asString?c.bytesToString(n):u.bytesToHex(n)}})();var H=x.exports;const F=A(H),S=E(),G={async login(u,l,s){try{const c=F(l),f=await w.post("/api/users/login",{email:u,password:c,phone:s});return f.data&&f.data.access_token&&(localStorage.setItem("access_token",f.data.access_token),console.log("Login successful:",f.data),S.setUser(f.data.userInfo)),f.data||{}}catch(c){throw console.error("Login error:",c),c}},async getUserInfo(){let u=await w.get("/api/users/userinfo");return console.log("== getUserInfo ==",u),u},async loginSMSCode(u,l){try{const c=await w.post("/api/users/login-sms-code",{phone:u,smsCode:l});return c.data&&c.data.access_token&&(localStorage.setItem("access_token",c.data.access_token),console.log("Login successful:",c.data),S.setUser(c.data.userInfo)),c.data||{}}catch(s){throw console.error("Login error:",s),s}},async register(u,l,s,c){try{const i=F(s);return(await w.post("/api/users/register",{name:u,email:l,phone:c,password:i})).data||{}}catch(i){throw console.error("Register error:",i),i}},async sendEmailVerification(u){try{return(await w.post("/api/users/sendEmailVerifyCode",{email:u})).data||{}}catch(l){throw console.error("Send email verification error:",l),l}},async verifyEmailVerifyCode(u,l){try{return(await w.post("/api/users/verifyEmailVerifyCode",{email:u,code:l})).data||{}}catch(s){throw console.error("Verify email verify code error:",s),s}},async verifySmsVerifyCode(u,l){try{return(await w.post("/api/users/verifySmsVerifyCode",{phone:u,code:l})).data||{}}catch(s){throw console.error("Verify sms code error:",s),s}},async updateUsername(u){try{return(await w.post("/api/users/updateUsername",{username:u})).data||{}}catch(l){throw console.error("Update username error:",l),l}},async resetPassword(u,l,s){try{const c="/api/users/resetPassword",i=F(l);return(await w.post(c,{email:u,password:i,phone:s})).data||{}}catch(c){throw console.error("Reset password error:",c),c}},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("lastSendTime"),localStorage.removeItem("user"),S.clear()},getCurrentUser(){const u=localStorage.getItem("user");return u?JSON.parse(u):null},isLoggedIn(){return!!localStorage.getItem("token")},async googleAuth(u,l){try{const c=await w.post("/api/users/google-auth",{code:u,redirect_uri:l});return c.data&&c.data.access_token&&(localStorage.setItem("access_token",c.data.access_token),S.setUser(c.data.userInfo)),c.data||{}}catch(s){throw console.error("Google auth error:",s),s}},async sendSmsCode(u){return(await w.post("/api/users/send-sms-code",{phone:u})).data||{}}};export{G as s};
